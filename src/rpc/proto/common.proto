syntax = "proto3";

package common;



message Read_Struct{
    uint64 key = 1;
    optional string value = 2;
    optional uint64 timestamp = 3;
    optional int32 table_id = 4;
}

message Write_Struct {
    uint64 key = 1;
    string value = 2;
}

enum TxnOP {
    Execute = 0;
    Commit = 1;
    Abort = 2;
}


message Msg {
    uint64 txn_id = 1;
    repeated common.Read_Struct read_set = 2;
    repeated common.Write_Struct write_set = 3;
    common.TxnOP op = 4;
    uint32 from = 5;
    optional uint64 commit_ts = 6;
}



message Echo {

}

message TS{
    uint64 ts = 1;
}
service DataService {
    rpc Propose(stream Msg) returns (stream Msg) {} 
}
service CtoService {
    rpc get_start_ts(Echo) returns(TS) {}
    rpc get_commit_ts(Echo) returns(TS) {}
}